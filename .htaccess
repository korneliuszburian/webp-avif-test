# Disable directory browsing
Options -Indexes

# Block direct access to PHP files
<FilesMatch "\.php$">
    # Apache 2.2
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
    
    # Apache 2.4+
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
</FilesMatch>

# Allow direct access to main plugin file
<Files "wp-image-optimizer.php">
    # Apache 2.2
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Allow from all
    </IfModule>
    
    # Apache 2.4+
    <IfModule mod_authz_core.c>
        Require all granted
    </IfModule>
</Files>

# Deny access to potential sensitive files
<FilesMatch "^.*\.(log|json|lock|yml|xml|md|txt|sql)$">
    # Apache 2.2
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
    
    # Apache 2.4+
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
</FilesMatch>
